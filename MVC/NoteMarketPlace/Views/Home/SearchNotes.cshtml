@model NoteMarketPlace.Models.SearchNotes
@{
    ViewBag.Title = "SearchNotes";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<header>
    <nav class="navbar navbar-expand-md fixed-top white-navbar">
        <div class="container nav-wrapper">

            <!-- Mobile Menu Open Button -->
            <span id="mobile-nav-open-btn">&#9776;</span>

            <div class="navbar-header">
                <a href="@Url.Action("Index", "Home", new { @class = "navbar-brand" }, null)">
                    <img id="logo" class="img-fluid" src="../../images/User-Profile/logo.png" alt="logo">
                </a>
            </div>
            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item">
                        @Html.ActionLink("Search Notes", "SearchNotes", "Home", new { area = "" }, new { @class = "nav-link active" })
                    </li>
                    @if (Session["userId"] != null)
                    {
                        <li class="nav-item">
                            @Html.ActionLink("Sell Your Notes", "Dashboard", "User", new { area = "" }, new { @class = "nav-link" })
                        </li>
                    }
                    else
                    {
                        <li class="nav-item">
                            @Html.ActionLink("Sell Your Notes", "Login", "Account", new { area = "" }, new { @class = "nav-link" })
                        </li>
                    }

                    @if (Session["userId"] != null)
                    {
                        <li class="nav-item">
                            @Html.ActionLink("Buyer Request", "BuyerRequest", "User", new { area = "" }, new { @class = "nav-link" })
                        </li>
                    }
                    <li class="nav-item">
                        @Html.ActionLink("FAQ", "FAQ", "Home", new { area = "" }, new { @class = "nav-link" })
                    </li>
                    <li class="nav-item">
                        @Html.ActionLink("Contact Us", "Contact", "Home", new { area = "" }, new { @class = "nav-link" })
                    </li>
                    @if (Session["userId"] != null)
                    {
                          
                        <li>
                            <div class="dropdown">
                                <a type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                                   aria-expanded="false">
                                    <img src="~/images/front/user-img.png" alt="">
                                </a>
                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">
                                    @Html.ActionLink("My Profile", "UserProfile", "User", new { area = "" }, new { @class = "dropdown-item" })
                                    <a class="dropdown-item" href="my-downloads-page.html">My Download</a>
                                    <a class="dropdown-item" href="my-sold-notes.html">My Sold Notes</a>
                                    <a class="dropdown-item" href="my-rejected-notes.html">My Rejected Notes</a>
                                    <a class="dropdown-item" href="#">Change Password</a>
                                    <a class="dropdown-item logout" href="login-page.html">Logout</a>

                                </div>
                            </div>
                        </li>
                    }
                    @if (Session["UserId"] != null)
                    {
                        <li class="nav-item">
                            @Html.ActionLink("Logout", "Logout", "Account", new { area = "" }, new { @class = "btn nav-link login-submit-btn" })
                        </li>
                    }
                    else
                    {
                        <li class="nav-item">
                            @Html.ActionLink("Login", "Login", "Account", new { area = "" }, new { @class = "btn nav-link login-submit-btn" })
                        </li>
                    }
                </ul>
            </div>

            <!-- Mobile Menu -->
            <div id="mobile-nav">
                <!-- Mobile Menu Close Button -->
                <span id="mobile-nav-close-btn">&times;</span>
                <img class="logo" src="~/images/User-Profile/logo.png" alt="">
                <div id="mobile-nav-content">
                    <ul class="nav">
                        <li><a class="link active" href="seacrh-page.html">Search Notes</a></li>
                        <li><a class="link" href="#">Sell Your Notes</a></li>
                        <li><a class="link" href="faq-page.html">FAQ</a></li>
                        <li><a class="link" href="contactUs-page.html">Contact Us</a></li>
                        <li><a class="btn login-submit-btn link" href="login-page.html">Logout</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
</header>

<div class="page-banner">
    <h2 class="page-banner-text">Search Notes</h2>
</div>

<section id="search-filter">
    <div class="content-box">
        <div class="container">

            <div class="row">
                <div class="col-md-12">
                    <h2 class="heading-sm">Search and Filter Notes</h2>
                </div>
            </div>
            <div class="row">
                <div id="search">

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group relative" id="input-search">
                                <input id="SearchNotess" type="text" class="form-control" placeholder="Search notes here...">
                                <img class="search-icon" src="~/images/Dashboard/search.jpg" alt="">
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-2 col-md-4 col-sm-4 col-6">
                            <div class="form-group">
                                @Html.DropDownListFor(m => m.TypeId, new SelectList(Model.Types, "Id", "Name"),
                                      "Select Type", new { value = "0", @class = "form-control remove-arrow" })
                                <img src="~/images/User-Profile/down-arrow.png" class="down-arrow-filter" alt="">
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-4 col-6">
                            <div class="form-group">
                                @Html.DropDownListFor(m => m.CategoryId, new SelectList(Model.Categories, "Id", "Name"),
                                      "Select Category", new { @class = "form-control remove-arrow" })
                               
                                <img src="~/images/User-Profile/down-arrow.png" class="down-arrow-filter" alt="">
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-4 col-6">
                            <div class="form-group">
                                @Html.DropDownListFor(m => m.UniversityId, new SelectList(Model.Universities),
                                     "Select University", new { @class = "form-control remove-arrow" })
                               
                                <img src="~/images/User-Profile/down-arrow.png" class="down-arrow-filter" alt="">
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-4 col-6">
                            <div class="form-group">
                                @Html.DropDownListFor(m => m.CourseId, new SelectList(Model.Courses),
                                      "Select Course", new { @class = "form-control remove-arrow" })
                                
                                <img src="~/images/User-Profile/down-arrow.png" class="down-arrow-filter" alt="">
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-4 col-6">
                            <div class="form-group">
                                @Html.DropDownListFor(m => m.CountryId, new SelectList(Model.Countries, "Id", "Name"),
                                      "Select Country", new { @class = "form-control remove-arrow", placeholder = "Select" })
                               
                                <img src="~/images/User-Profile/down-arrow.png" class="down-arrow-filter" alt="">
                            </div>
                        </div>
                        <div class="col-lg-2 col-md-4 col-sm-4 col-6">
                            <div class="form-group">
                                <select class="form-control remove-arrow" id="type">
                                    <option value="">Select Rating </option>
                                </select>
                                <img src="~/images/User-Profile/down-arrow.png" class="down-arrow-filter" alt="">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="searched-notes">
    <div class="content-box">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h2 class="heading-sm" id="Total-count">Total @Model.sellerNotes.Count() Notes</h2>
                </div>

            </div>
            <div class="row" id="Main-notes">
                @foreach (var note in Model.sellerNotes)
                {
                    <div class="col-lg-4 col-md-6 col-sm-6 for-note-detail" onclick="location.href='@Url.Action("ViewNote", "User", new { id = note.ID })';" style="cursor: pointer;" data-note-id="@note.ID">
                        <div class="note-wrapper">
                            <div class="note-display-img" style="height:253px;margin-bottom:20px;">
                                <img style="height:100%;object-fit:cover;" src="@Url.Content("~/Members/" + note.SellerID + "/" + note.ID + "/" + note.DisplayPicture)" class="img-fluid note-image" alt="">
                            </div>
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="office">
                                            <div class="heading">
                                                <h3 class="heading-sm">
                                                    @note.Title
                                                </h3>
                                            </div>
                                            <ul class="university-details">
                                                <li>
                                                    <span class="university-detail-img text-center">
                                                        <img src="~/images/front/university.png" alt="">
                                                    </span><span>@note.UniversityName</span>
                                                </li>
                                                <li>
                                                    <span class="university-detail-img text-center">
                                                        <img src="~/images/front/pages.png" alt="">
                                                    </span>
                                                    <span>@note.NumberOfPages Pages</span>
                                                </li>
                                                <li>
                                                    <span class="university-detail-img text-center">
                                                        <img src="~/images/front/date.png" alt="">
                                                    </span>
                                                    @{ DateTime d = (DateTime)note.CreatedDate; var dd = d.ToString("ddd, MMM dd yyyy");}
                                                    <span>@dd</span>
                                                </li>
                                                <li>
                                                    <span class="university-detail-img text-center">
                                                        <img src="~/images/front/flag.png" alt="">
                                                    </span>
                                                    <span>5 Users marked this note as inappropriate</span>
                                                </li>
                                                <li>
                                                    <span class="starss">
                                                        @for (var i = 0; i < 5; i++)
                                                        {
                                                            if (i < 4)
                                                            {
                                                                <i class="fa fa-star"></i>
                                                            }
                                                            else
                                                            {
                                                                <i class="fa fa-star-o"></i>
                                                            }
                                                        }
                                                        <p>23 reviews</p>
                                                    </span>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                }

            </div>
        </div>
    </div>
</section>


<nav id="pagination" aria-label="Page navigation example">
    <ul class="pagination">
        <li class="page-item">
            <a class="page-link" href="#" aria-label="Previous">
                <span aria-hidden="true"><i class="fa fa-chevron-left"></i></span>
            </a>
        </li>
        <li class="page-item"><a class="page-link active" href="">1</a></li>
        <li class="page-item"><a class="page-link" href="#">2</a></li>
        <li class="page-item"><a class="page-link" href="#">3</a></li>
        <li class="page-item"><a class="page-link" href="#">4</a></li>
        <li class="page-item"><a class="page-link" href="#">5</a></li>
        <li class="page-item">
            <a class="page-link" href="#" aria-label="Next">
                <span aria-hidden="true"><i class="fa fa-chevron-right"></i></span>
            </a>
        </li>
    </ul>
</nav>
@Html.Partial("_Footer")
@section scripts
{
    <script>

        $(document).ready(function () {


            $("select").children("option:first-child").val(0);
            $("select").val(0);

            $("#CategoryId, #TypeId, #CountryId, #UniversityId, #CourseId, #SearchNotess").on("change", function () {

                var Categoryid = $("#CategoryId").val();
                var Typeid = $("#TypeId").val();
                var Countryid = $("#CountryId").val();
                var Universityid = $("#UniversityId").val();
                var Courseid = $("#CourseId").val();
                var search = $("#SearchNotess").val();

                $.ajax({
                    method: "POST",
                    url: "@Url.Action("FilterNote", "User")?searchVal=" + search + "&CategoryId=" + Categoryid + "&TypeId=" + Typeid + "&University=" + Universityid + "&Course=" + Courseid +  "&CountryId=" + Countryid,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    error: function (request) { console.log(request); },
                    success: function (notes) {

                        var main = $("#Main-notes");
                        main.html("");
                        $("#Total-count").html("");
                        var count = `Total ${notes.length} Notes`
                        $("#Total-count").append(count);
                        notes.forEach(note => {
                            var wrapperDiv = `<div  class="col-lg-4 col-md-6 col-sm-6 for-note-detail" onclick="location.href='/User/ViewNote/${note.ID}';" style="cursor: pointer;" data-note-id="${note.ID}">
                            <div class="note-wrapper">
                                <div class="note-display-img" style="height:253px;margin-bottom:20px;">
                                    <img style="height:100%;object-fit:cover;" src="/Members/${note.SellerID}/${note.ID}/${note.DisplayPicture}" class="img-fluid note-image" alt="">
                                </div>
                                <div class="container">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="office">
                                                <div class="heading">
                                                    <h3 class="heading-sm">
                                                        ${note.Title}
                                                    </h3>
                                                </div>
                                                <ul class="university-details">
                                                    <li>
                                                        <span class="university-detail-img text-center">
                                                            <img src="/images/front/university.png" alt="">
                                                        </span><span>${note.UniversityName}</span>
                                                    </li>
                                                    <li>
                                                        <span class="university-detail-img text-center">
                                                            <img src="/images/front/pages.png" alt="">
                                                        </span>
                                                        <span>${note.NumberOfPages} Pages</span>
                                                    </li>
                                                    <li>
                                                        <span class="university-detail-img text-center">
                                                            <img src="/images/front/date.png" alt="">
                                                        </span>
                                                        <span>${note.CreatedDate}</span>
                                                    </li>
                                                    <li>
                                                        <span class="university-detail-img text-center">
                                                            <img src="/images/front/flag.png" alt="">
                                                        </span>
                                                        <span>5 Users marked this note as inappropriate</span>
                                                    </li>
                                                    <li>
                                                      <span class="starss">
                                                            @for (var i = 0; i < 5; i++)
                                                            {
                                                                if (i < 4)
                                                                {
                                                                    <i class="fa fa-star"></i>
                                                                }
                                                                else
                                                                {
                                                                    <i class="fa fa-star-o"></i>
                                                                }
                                                            }
                                                            <p>23 reviews</p>
                                                        </span>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>`

                            main.append(wrapperDiv);

                        })

                    }
                })

            })
        })
    </script>
}